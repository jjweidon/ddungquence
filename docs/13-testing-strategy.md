# 13. 테스트 전략

## 1) 목표
- 룰(도메인)은 단위 테스트로 확실히 잠근다.
- Firestore 동기화는 에뮬레이터 기반 통합 테스트로 최소 보장한다.
- MVP는 “핵심 플로우 1~2개”만 e2e로 커버한다.

## 2) 레이어별 테스트

### 2.1 도메인 단위 테스트(P0)
대상:
- 덱 생성/셔플(104장, 중복/누락 없음)
- 잭 규칙(2-eye 배치, 1-eye 제거 제한)
- 데드 카드 판정(변형: 사용 불가로 손에 유지, 교체 없음)
- 시퀀스 판정(가로/세로/대각, 변형: 코너도 5칸 점유, 공유 없음, 중복 1칸 허용)

도구:
- Vitest 권장(빠름)

### 2.2 리포지토리 통합 테스트(P1)
대상:
- room 생성/참가/ready
- 게임 시작 딜링(호스트만)
- 턴 액션 트랜잭션 충돌(expectedVersion mismatch)

도구:
- Firebase Emulator + Vitest

### 2.3 E2E(최소)(P1)
시나리오:
- 2명이 방 생성/참가 → start → 3턴 진행 → 화면 동기화 확인

도구:
- Playwright(선택)

## 3) 테스트 데이터/픽스처
- 보드 레이아웃은 상수 JSON으로 제공하며, 그 내용은 01-game-rules의 boardImages와 동일(18-board-layout 참조)
- 테스트는 “결정적 덱”(seed 기반)으로 작성(셔플 테스트는 별도)

## 4) DoD 체크리스트
- [ ] 시퀀스 판정 테스트 케이스가 최소 10개 이상 존재
- [ ] 잭(2-eye/1-eye, 제거 후 바로 다음만 two-eyed jack 금지)/데드 카드(변형) 케이스가 누락 없이 커버
