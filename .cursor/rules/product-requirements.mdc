---
description: USE WHEN implementing features or checking scope/acceptance criteria. Summarizes P0 FR/NFR for MVP.
globs: docs/**/*.md,src/**/*.ts,src/**/*.tsx
alwaysApply: false
---
# 제품 요구사항(요약) — 구현/스펙 판단 기준

## 성공 기준(Outcome)
- 4명이 방에 들어와 **10초 내 게임 시작**
- 1턴 처리(내 액션 → 상대 반영)가 **체감 1초대**
- 모바일 보드 조작(탭/드래그/확대)이 불편하지 않음
- 운영 비용: Firebase 무료 구간(또는 소액) 유지

## P0 기능 스코프
### 계정/세션
- Firebase Auth **Google 로그인**으로 uid 발급
- 새로고침해도 uid 유지(동일 브라우저)
- 닉네임: Google displayName 또는 자동 닉네임(Player-AB12)

### 로비/방
- 방 생성(P0): 6자리 코드(예: Base32), host 지정, 생성 후 로비 이동, 코드 복사
- 방 참가(P0): 코드 입력 → roomCodes 조회 → players/{uid} 생성
- 관전 정책(P0):
  - 참가 자리 없으면 **자동 관전**(spectator)
  - 관전 최대 2명, 초과 시 입장 불가
  - 게임 진행 중에는 신규 관전 입장 불가(기존 관전자 퇴장만)
  - 참여자는 퇴장 버튼 없음(끊김/종료 시 자동 퇴장), 관전자만 퇴장 버튼
- 로비 상태(P0):
  - 참여자/관전자 목록 표시(구역 분리)
  - Ready 토글/팀 선택은 본인 players 문서 업데이트로
  - host만 게임 시작 가능
- 팀 배정(P0): MVP는 A/B 2팀
  - 색상 배정 순서: 레드 → 블루 → 그린(확장)

### 게임(턴 기반)
- host 게임 시작(P0): 덱 셔플/딜링, 보드 초기화, 첫 턴 결정
- 손패 UI(P0): 내 턴이 아니면 선택 불가, 선택 시 가능한 칸 하이라이트
- 일반 카드(P0): 대응 칸 중 빈칸 선택 → 칩 배치 → 자동 드로우
- 잭(P0):
  - 2-eye: 빈칸 어디든 배치(코너 포함)
  - 1-eye: 상대 칩 제거(완성 시퀀스 칩 제거 금지)
  - 변형: 제거된 칸은 **바로 다음 플레이어만** 2-eye로 배치 불가
- 데드 카드(P0, 변형): 교체 없음. 손에 유지하며 사용 불가.
- 시퀀스 판정(P0): 가로/세로/대각 5연속, 2시퀀스 모드 중복 1칸 허용
- 실시간(P0): room public 상태 구독 + private hand 구독

### 복원
- 재접속/새로고침 시 같은 uid면 로비/게임 상태 자동 복귀

## 비기능(NFR) 핵심
- 모바일 LCP 3초 이내(중간급 안드로이드 기준)
- 액션 후 상태 반영 1초 이내(평균), 3초 초과는 지연 UI
- 트랜잭션/버전 기반으로 중복 제출 방지
- PII 저장 금지
